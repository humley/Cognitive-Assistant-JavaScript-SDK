"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),__awaiter=function(a,b,c,d){return new(c||(c=Promise))(function(e,f){function g(a){try{i(d.next(a))}catch(a){f(a)}}function h(a){try{i(d.throw(a))}catch(a){f(a)}}function i(a){a.done?e(a.value):new c(function(b){b(a.value)}).then(g,h)}i((d=d.apply(a,b)).next())})},CheckPoint=function(){function a(b){_classCallCheck(this,a),this.baseUri="http://api.humley.com/iviewsessions/sessionswebcalls.asmx",this.appId=b}return _createClass(a,[{key:"createSession",value:function(b){var c=this;$.soap({url:this.baseUri,method:"createSession",SOAPAction:"http://localhost/SessionsWebCalls/SessionsWebCalls/createSession",appendMethodToURL:!1,envAttributes:{c:"http://schemas.xmlsoap.org/soap/encoding/",d:"http://www.w3.org/2001/XMLSchema",i:"http://www.w3.org/2001/XMLSchema-instance"},namespaceURL:"http://localhost/SessionsWebCalls/SessionsWebCalls",data:{AppID:this.appId,MSISDN:b.MSISDN||"",IPAddress:b.IPAddress||"",User_Agent:navigator.userAgent,IMEI:b.IMEI||"",UUID:b.UUID||""},success:function(d){var e=d.toJSON();"true"===e.Body.createSessionResponse.createSessionResult.result.HasError&&console.error(e.Body.createSessionResponse.createSessionResult.result.StatusCode,e.Body.createSessionResponse.createSessionResult.result.StatusMessage),c.sessionId=e.Body.createSessionResponse.createSessionResult.resultString,b.sendCheckPoint&&c.CheckPointReachedWithVariable({checkpointID:"8018",variableName:"LF",variableValue:"4"}).then(function(a){console.log(a)},function(a){console.error(a)})},error:function(b){console.error(b.toString())}})}},{key:"xmlToJson",value:function(b){var c={};if(1==b.nodeType){if(b.attributes.length>0){c["@attributes"]={};for(var d=0;d<b.attributes.length;d++){var e=b.attributes.item(d);c["@attributes"][e.nodeName]=e.nodeValue}}}else 3==b.nodeType&&(c=b.nodeValue);if(b.hasChildNodes())for(var f=0;f<b.childNodes.length;f++){var g=b.childNodes.item(f),h=g.nodeName.substring(g.nodeName.indexOf(":")+1).replace("#","");if("undefined"==typeof c[h])c[h]=this.xmlToJson(g);else{if("undefined"==typeof c[h].push){var i=c[h];c[h]=[],c[h].push(i)}c[h].push(this.xmlToJson(g))}}return c}},{key:"CheckPointReachedWithVariable",value:function(b){return __awaiter(this,void 0,Promise,regeneratorRuntime.mark(function a(){var d,c=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return d=this,e.abrupt("return",new Promise(function(a,e){$.post("http://api.humley.com/iviewsessions/sessionswebcalls.asmx/CheckPointReachedWithVariable",{sessionId:c.sessionId,checkpointID:b.checkpointID,variableName:b.variableName,variableValue:b.variableValue}).done(function(b){a(d.xmlToJson(b).CheckPointLogged.result)}).fail(function(a){e(d.xmlToJson(a))})}));case 2:case"end":return e.stop()}},a,this)}))}}]),a}();